
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Automated Tests &#8212; The UChicago χ-Projects</title>

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/chiweb.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="chistributed" href="../chistributed/index.html" />
    <link rel="prev" title="Testing your Implementation" href="testing.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-27880910-3', 'auto');
  ga('send', 'pageview');

</script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          The UChicago χ-Projects</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../about.html">About</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Projects <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc">
      
      <li class="toctree-l1"><a class="reference internal" href="../chidb/index.html">chidb</a></li>
      <li class="toctree-l1"><a class="reference internal" href="../chirc/index.html">chirc</a></li>
      <li class="toctree-l1"><a class="reference internal" href="../chitcp/index.html">chiTCP</a></li> 
      <li class="toctree-l1"><a class="reference internal" href="index.html">chirouter</a></li> 
      <li class="toctree-l1"><a class="reference internal" href="../chistributed/index.html">chistributed</a></li>
      <li class="toctree-l1"><a class="reference internal" href="../chisubmit/index.html">chisubmit</a></li>      
  </ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
<div class="row">
    <div class="col-md-12">
        <ul class="breadcrumb">
          <li><a href="../index.html">The UChicago χ-Projects</a></li>
          <li><a href="index.html">chirouter</a></li>
            <li class="active">Automated Tests</li>
        </ul>
    </div>
</div>

    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="automated-tests">
<span id="chirouter-automated-tests"></span><h1>Automated Tests<a class="headerlink" href="automated-tests.html#automated-tests" title="Permalink to this headline">¶</a></h1>
<p>chirouter includes a set of automated tests that largely mimic the tests
described in the <a class="reference external" href="testing.html">Testing your Implementation</a> page.
To run the automated tests, just run the following from inside the
<code class="docutils literal notranslate"><span class="pre">build/</span></code> directory:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>make tests
</pre></div>
</div>
<p>This will build your code and will run all the tests. To obtain
a summary of how many points you scored on the tests, you must also
run this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>make grade
</pre></div>
</div>
<div class="section" id="invoking-py-test-directly">
<h2>Invoking py.test directly<a class="headerlink" href="automated-tests.html#invoking-py-test-directly" title="Permalink to this headline">¶</a></h2>
<p>You can have greater control on what tests are run by invoking py.test directly.
When doing so, you must make sure that you’ve built the latest version of your
code (using the make targets above will do so automatically, but running
py.test directly will not).</p>
<p>Please note that you must run py.test from the root of your repository
(<em>not</em> from inside the <code class="docutils literal notranslate"><span class="pre">build/</span></code> directory). We suggest you run it like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>make &amp;&amp; sudo py.test src/python/chirouter/tests/ &lt;PYTEST OPTIONS&gt;
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">&lt;PYTEST</span> <span class="pre">OPTIONS&gt;</span></code> are the options described in the sections below.
A few parameters that are useful across the board are the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-x</span></code>: Stop after the first failed test. This can be useful when you’re failing
multiple tests, and want to focus on debugging one failed test at a time.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-s</span></code>: Do not suppress output from successful tests. By default, py.test only
shows the output produced by chirouter if a test fails. In some cases, you may want
to look at the log messages of a successful test; use this option to force py.test
to show the output for that test.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--chirouter-loglevel</span> <span class="pre">N</span></code>: This controls the logging level of the chirouter server run
by the tests. You can specify the following values for <code class="docutils literal notranslate"><span class="pre">N</span></code>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code>: Corresponds to the default level of logging.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code>: Corresponds to calling chirouter with the <code class="docutils literal notranslate"><span class="pre">-v</span></code> option.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code>: Corresponds to calling chirouter with the <code class="docutils literal notranslate"><span class="pre">-vv</span></code> option.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code>: Corresponds to calling chirouter with the <code class="docutils literal notranslate"><span class="pre">-vvv</span></code> option.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="running-categories-of-tests">
<h2>Running categories of tests<a class="headerlink" href="automated-tests.html#running-categories-of-tests" title="Permalink to this headline">¶</a></h2>
<p>If you want to run only a specific category of tests, you can use the
<code class="docutils literal notranslate"><span class="pre">--chirouter-category</span></code> parameter. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo py.test src/python/chirouter/tests/ --chirouter-category RESPONDING_ARP_REQUESTS
</pre></div>
</div>
<p>To see the exact categories available in each assignment, run the following
inside the <code class="docutils literal notranslate"><span class="pre">build/</span></code> directory:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>make test-categories
</pre></div>
</div>
</div>
<div class="section" id="running-individual-tests">
<h2>Running individual tests<a class="headerlink" href="automated-tests.html#running-individual-tests" title="Permalink to this headline">¶</a></h2>
<p>If you want to focus on debugging an individual test that is failing, you can
run a single test by using the <code class="docutils literal notranslate"><span class="pre">-k</span></code> parameter:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo py.test src/python/chirouter/tests/ -k test_ping_router
</pre></div>
</div>
<p>The name of each failed test can be found after the <code class="docutils literal notranslate"><span class="pre">FAILURES</span></code> line in the output
from the tests. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>===================================== FAILURES =====================================
_____________________  TestTraceroute.test_traceroute_router _______________________
</pre></div>
</div>
</div>
<div class="section" id="debugging-a-test-with-a-debugger">
<h2>Debugging a test with a debugger<a class="headerlink" href="automated-tests.html#debugging-a-test-with-a-debugger" title="Permalink to this headline">¶</a></h2>
<p>If you want to debug a test with a debugger, such as gdb, you will have to run chirouter separately
from the tests (using the debugger), and then instruct the tests to connect to that server (instead of having the
tests launch chirouter on their own).</p>
<p>If using gdb, you would have to run chirouter like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>gdb --args ./chirouter -vv -p 23399
</pre></div>
</div>
<p>This starts chirouter using port 23399 (don’t forget to then use gdb’s <code class="docutils literal notranslate"><span class="pre">run</span></code> command
to actually run the server).</p>
<p>Similarly, if using Valgrind, you would have to run chirouter like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>valgrind ./chirouter -vv -p 23399
</pre></div>
</div>
<p>Next, you will use the <code class="docutils literal notranslate"><span class="pre">--chirouter-external-port</span> <span class="pre">PORT</span></code> option to instruct py.test to
use the server you’re running with a debugger:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo py.test src/python/chirouter/tests/ --chirouter-external-port 23399 -k test_ping_router
</pre></div>
</div>
<p>Take into account that the <code class="docutils literal notranslate"><span class="pre">--chirouter-external-port</span></code> only makes sense when running a single
test, so you will also have to use the <code class="docutils literal notranslate"><span class="pre">-k</span></code> option to specify what test to run.</p>
</div>
</div>


    </div>
    
<nav class="related">
  <ul class="pager">
    <li class="previous">
    <a href="testing.html" title="Previous Chapter: Testing your Implementation"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Testing your Implementation</span>
    </a>    
    </li>
    <li class="next">
    <a href="../chistributed/index.html" title="Next Chapter: chistributed"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">chistributed &raquo;</span>
    </a>    
    </li>
  </ul>
</nav>

  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="automated-tests.html#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2010-2022, The University of Chicago.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.3.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>