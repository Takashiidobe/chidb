
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Installing, Building, and Running chirouter &#8212; The UChicago χ-Projects</title>

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/chiweb.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Implementation Guide" href="implementing.html" />
    <link rel="prev" title="Introduction" href="intro.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-27880910-3', 'auto');
  ga('send', 'pageview');

</script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          The UChicago χ-Projects</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../about.html">About</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Projects <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc">
      
      <li class="toctree-l1"><a class="reference internal" href="../chidb/index.html">chidb</a></li>
      <li class="toctree-l1"><a class="reference internal" href="../chirc/index.html">chirc</a></li>
      <li class="toctree-l1"><a class="reference internal" href="../chitcp/index.html">chiTCP</a></li> 
      <li class="toctree-l1"><a class="reference internal" href="index.html">chirouter</a></li> 
      <li class="toctree-l1"><a class="reference internal" href="../chistributed/index.html">chistributed</a></li>
      <li class="toctree-l1"><a class="reference internal" href="../chisubmit/index.html">chisubmit</a></li>      
  </ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
<div class="row">
    <div class="col-md-12">
        <ul class="breadcrumb">
          <li><a href="../index.html">The UChicago χ-Projects</a></li>
          <li><a href="index.html">chirouter</a></li>
            <li class="active">Installing, Building, and Running chirouter</li>
        </ul>
    </div>
</div>

    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="installing-building-and-running-chirouter">
<span id="chirouter-installing"></span><h1>Installing, Building, and Running chirouter<a class="headerlink" href="installing.html#installing-building-and-running-chirouter" title="Permalink to this headline">¶</a></h1>
<p>The source code for chirouter can be found in the following GitHub repository:</p>
<p><a class="reference external" href="https://github.com/uchicago-cs/chirouter">https://github.com/uchicago-cs/chirouter</a></p>
<p>To work on the assignments, all you need to do is clone this repository. However,
please note that your instructor may give you more specific instructions on how
to get the chirouter code.</p>
<div class="section" id="software-requirements">
<h2>Software Requirements<a class="headerlink" href="installing.html#software-requirements" title="Permalink to this headline">¶</a></h2>
<p>chirouter has the following requirements:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://cmake.org/">CMake</a> (version 3.5.1 or higher)</p></li>
<li><p><a class="reference external" href="http://mininet.org/">mininet</a> (2.3.0 or higher), a network emulator that requires root access on a Linux machine. If you do not have root access on your personal computer, we recommend running mininet inside a virtual machine (the mininet website actually provides some ready-to-use virtual machines).</p></li>
<li><p><a class="reference external" href="https://ryu-sdn.org/">Ryu SDN Framework</a> (installed from source)</p></li>
</ul>
</div>
<div class="section" id="building">
<h2>Building<a class="headerlink" href="installing.html#building" title="Permalink to this headline">¶</a></h2>
<p>The first time you download the chirouter code to your machine, you must run the
following from the root of the chirouter code tree:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cmake -B build/
</pre></div>
</div>
<p>This will generate a number of files necessary to build chirouter.</p>
<p>Once you have done this, simply run <code class="docutils literal notranslate"><span class="pre">make</span></code> inside the <code class="docutils literal notranslate"><span class="pre">build</span></code> directory
to build chirouter. This will generate the <code class="docutils literal notranslate"><span class="pre">chirouter</span></code> executable.</p>
<p>This executable accepts the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">PORT</span></code>: [Optional] Port that chirouter will listen on (mininet and POX will use this port
to send the router its configuration information). Defaults to 23300.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-c</span> <span class="pre">FILE</span></code>: [Optional] When specified, produces a capture file (in PCAPNG format) with all
the Ethernet frames sent/received by the routers. This file can be opened in Wireshark for analysis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-v</span></code>, <code class="docutils literal notranslate"><span class="pre">-vv</span></code>, or <code class="docutils literal notranslate"><span class="pre">-vvv</span></code>: To control the level of logging. This is described in
more detail in <a class="reference internal" href="implementing.html#chirouter-implementing"><span class="std std-ref">Implementation Guide</span></a></p></li>
</ul>
</div>
<div class="section" id="running">
<h2>Running<a class="headerlink" href="installing.html#running" title="Permalink to this headline">¶</a></h2>
<p>To run chirouter, you must first run mininet to simulate the network where your router is located.
Running mininet requires root access, but running the chirouter executable <em>does not</em>.
So, there are two ways of running chirouter:</p>
<div class="section" id="running-chirouter-and-mininet-on-a-machine-with-root-access">
<h3>Running chirouter and mininet on a machine with root access<a class="headerlink" href="installing.html#running-chirouter-and-mininet-on-a-machine-with-root-access" title="Permalink to this headline">¶</a></h3>
<p>If you have root access on the machine you are working on, you should start two terminals
and, on the first one, run chirouter:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>./chirouter -vv
</pre></div>
</div>
<p>Note: The <code class="docutils literal notranslate"><span class="pre">-vv</span></code> parameter is not ordinarily necessary, but we will use it to verify that
chirouter and mininet are running correctly.</p>
<p>You should see the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[2018-02-09 10:41:13]   INFO Waiting for connection from controller...
</pre></div>
</div>
<p>In a separate terminal, run mininet like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo ./run-mininet topologies/basic.json
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">sudo</span></code> will ask you to enter your password; once you do so, you should see the following output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>*** Creating network
*** Adding controller
*** Adding hosts:
client1 client2 server1 server2
*** Adding switches:
r1 s1001 s1002 s1003
*** Adding links:
(client1, s1003) (client2, s1003) (r1, s1001) (r1, s1002) (r1, s1003) (server1, s1001) (server2, s1002)
*** Configuring hosts
client1 client2 server1 server2
*** Starting SimpleHTTPServer on host server1
*** Starting SimpleHTTPServer on host server2
*** Starting controller
c0
*** Starting 4 switches
r1 s1001 s1002 s1003 ...
*** Starting CLI:
mininet&gt;
</pre></div>
</div>
<p>Now, the terminal where you ran <code class="docutils literal notranslate"><span class="pre">chirouter</span></code> should show something like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[2022-02-18 18:16:51]   INFO Controller connected from 127.0.0.1:35450
[2022-02-18 18:16:51]   INFO Received 1 routers
[2022-02-18 18:16:51]   INFO --------------------------------------------------------------------------------
[2022-02-18 18:16:51]   INFO ROUTER r1
[2022-02-18 18:16:51]   INFO
[2022-02-18 18:16:51]   INFO eth1 82:58:1A:BC:08:4B 192.168.1.1
[2022-02-18 18:16:51]   INFO eth2 5E:E4:3E:37:91:5A 172.16.0.1
[2022-02-18 18:16:51]   INFO eth3 0A:F4:73:75:97:12 10.0.0.1
[2022-02-18 18:16:51]   INFO
[2022-02-18 18:16:51]   INFO Destination     Gateway         Mask            Iface
[2022-02-18 18:16:51]   INFO 192.168.0.0     0.0.0.0         255.255.0.0     eth1
[2022-02-18 18:16:51]   INFO 172.16.0.0      0.0.0.0         255.255.240.0   eth2
[2022-02-18 18:16:51]   INFO 10.0.0.0        0.0.0.0         255.0.0.0       eth3
[2022-02-18 18:16:51]   INFO --------------------------------------------------------------------------------
</pre></div>
</div>
<p>Note: The MAC addresses will likely be different. Everything else should be the same.</p>
<p>This means that chirouter has correctly received the network configuration from mininet.</p>
<p>Go back to the mininet terminal, which should show a command prompt like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mininet&gt;
</pre></div>
</div>
<p>To verify that mininet is running correctly, you can run the following from the mininet prompt:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mininet&gt; client1 ping -c 4 client1
PING 10.0.100.1 (10.0.100.1) 56(84) bytes of data.
64 bytes from 10.0.100.1: icmp_seq=1 ttl=64 time=0.018 ms
64 bytes from 10.0.100.1: icmp_seq=2 ttl=64 time=0.014 ms
64 bytes from 10.0.100.1: icmp_seq=3 ttl=64 time=0.022 ms
64 bytes from 10.0.100.1: icmp_seq=4 ttl=64 time=0.023 ms

--- 10.0.100.1 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 2999ms
rtt min/avg/max/mdev = 0.014/0.019/0.023/0.004 ms
</pre></div>
</div>
<p>The above command just instructs <code class="docutils literal notranslate"><span class="pre">client1</span></code> to ping itself. Since your router isn’t involved in delivering the
ICMP messages, this will run fine even if you haven’t implemented the router yet. On the other hand, the following
command instructs <code class="docutils literal notranslate"><span class="pre">client1</span></code> to ping <code class="docutils literal notranslate"><span class="pre">10.0.0.1</span></code> (one of the router’s interfaces). Since you have
not yet implemented ICMP in your router, it will not reply to the pings:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mininet&gt; client1 ping -c 4 10.0.0.1
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
From 10.0.100.1 icmp_seq=1 Destination Host Unreachable
From 10.0.100.1 icmp_seq=2 Destination Host Unreachable
From 10.0.100.1 icmp_seq=3 Destination Host Unreachable
From 10.0.100.1 icmp_seq=4 Destination Host Unreachable

--- 10.0.0.1 ping statistics ---
4 packets transmitted, 0 received, +4 errors, 100% packet loss, time 3014ms
</pre></div>
</div>
<p>However, if you look at the chirouter logs, you should see that it <em>is</em> receiving the ARP requests from <code class="docutils literal notranslate"><span class="pre">client1</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[2022-02-18 18:18:21]  DEBUG Received Ethernet frame on interface r1-eth3
[2022-02-18 18:18:21]  DEBUG    ######################################################################
[2022-02-18 18:18:21]  DEBUG &lt;  Src: 26:0F:6D:1B:55:DD
[2022-02-18 18:18:21]  DEBUG &lt;  Dst: FF:FF:FF:FF:FF:FF
[2022-02-18 18:18:21]  DEBUG &lt;  Ethertype: 0806 (ARP)
[2022-02-18 18:18:21]  DEBUG &lt;  Payload (28 bytes):
[2022-02-18 18:18:21]  DEBUG   0000  00 01 08 00 06 04 00 01 26 0f 6d 1b 55 dd 0a 00  ........&amp;.m.U...
[2022-02-18 18:18:21]  DEBUG   0010  64 01 00 00 00 00 00 00 0a 00 00 01              d...........
[2022-02-18 18:18:21]  DEBUG    ######################################################################
</pre></div>
</div>
<p>As you develop your router, please note that it is important that you start chirouter and mininet in
the same order: chirouter first, followed by mininet.</p>
</div>
<div class="section" id="running-chirouter-and-mininet-on-separate-machines">
<h3>Running chirouter and mininet on separate machines<a class="headerlink" href="installing.html#running-chirouter-and-mininet-on-separate-machines" title="Permalink to this headline">¶</a></h3>
<p>Since mininet requires root access, it may sometimes be more convenient to run chirouter on your usual
development machine (e.g., your laptop), and mininet on a machine with root access. In particular,
it should be easy to run mininet inside a virtual machine running on the same machine where
you are doing your chirouter development.</p>
<p>To do this, you should clone your repository on the (non-root) machine, and run chirouter as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>./chirouter -vv -p PORT
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">PORT</span></code> is the TCP port on which chirouter will listen for connections from mininet. If you
omit this parameter, port 23300 will be used by default.</p>
<p>Next, on the root machine, it is enough to clone the upstream chirouter repository. In fact, none of your own
code will run on the root machine; only the mininet code (which you do not need to modify in any way)
will run there.</p>
<p>From the root machine, run mininet as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo ./run-mininet topologies/basic.json --chirouter HOST:PORT
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">HOST</span></code> is the hostname or IP address of the machine running chirouter. If you are running mininet
inside a virtual machine, there will typically be a special IP address to connect to the VM’s host machine
(which is where you’re running chirouter). <code class="docutils literal notranslate"><span class="pre">PORT</span></code> is the port specified when running <code class="docutils literal notranslate"><span class="pre">chirouter</span></code> (or
23300 if you did not specify a <code class="docutils literal notranslate"><span class="pre">-p</span></code> parameter when running <code class="docutils literal notranslate"><span class="pre">chirouter</span></code>)</p>
<p>You should now observe the same outputs as described earlier.</p>
</div>
<div class="section" id="running-mininet-and-ryu-separately">
<h3>Running mininet and Ryu separately<a class="headerlink" href="installing.html#running-mininet-and-ryu-separately" title="Permalink to this headline">¶</a></h3>
<p>It can sometimes be useful, for debugging purposes, to run mininet and the Ryu controller separately (in general,
you should not do this unless your instructor asks you for the output of Ryu). To do so, you must run
the following commands in separate terminals, and in this order:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>./chirouter -vv
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>./run-pox topologies/basic.json
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo ./run-mininet topologies/basic.json --remote-controller 127.0.0.1:6633
</pre></div>
</div>
</div>
</div>
</div>


    </div>
    
<nav class="related">
  <ul class="pager">
    <li class="previous">
    <a href="intro.html" title="Previous Chapter: Introduction"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Introduction</span>
    </a>    
    </li>
    <li class="next">
    <a href="implementing.html" title="Next Chapter: Implementation Guide"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Implementation Guide &raquo;</span>
    </a>    
    </li>
  </ul>
</nav>

  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="installing.html#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2010-2022, The University of Chicago.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.3.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>